(("undefined"!==typeof self?self:this)["webpackChunkrancher_ai_ui_0_1_8"]=("undefined"!==typeof self?self:this)["webpackChunkrancher_ai_ui_0_1_8"]||[]).push([[194],{26:function(e,t,a){var n=a(5690);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("70175c70",n,!0,{sourceMap:!1,shadowMode:!1})},94:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".thinking-message .dots[data-v-611b6c7d]{display:inline-flex;width:12px}",""]),t["default"]=c},483:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".chat-message[data-v-903c9360]{display:flex;gap:8px}.chat-msg-content[data-v-903c9360]{margin-right:40px}.chat-message-user[data-v-903c9360]{flex-direction:row-reverse}.chat-message-user .chat-msg-content[data-v-903c9360]{display:flex;flex-direction:column;align-items:flex-end;margin:0}.chat-message-user .chat-msg-text[data-v-903c9360],.chat-msg-bubble[data-v-903c9360]{color:var(--body-text)}.chat-msg-bubble[data-v-903c9360]{position:relative;max-width:455px;background:var(--body-bg);border:1px solid var(--border);border-radius:12px;box-shadow:0 2px 8px 0 rgba(0,0,0,.04);padding:12px;font-size:.95rem;display:flex;flex-direction:column;gap:6px}.chat-msg-bubble:hover .chat-msg-bubble-actions[data-v-903c9360]{opacity:1;pointer-events:auto}.chat-msg-bubble-user[data-v-903c9360]{background:var(--tertiary-hover);align-items:flex-end}.chat-msg-bubble-error[data-v-903c9360]{background:var(--error-banner-bg);border-color:var(--error);color:var(--error-banner-text,var(--error))}.chat-msg-bubble-actions[data-v-903c9360]{position:absolute;top:-15px;right:-15px;display:flex;gap:5px;z-index:2;opacity:0;pointer-events:none;transition:opacity .2s}.bubble-action-btn[data-v-903c9360]{background:var(--body-bg);border:1.5px solid var(--border);border-radius:8px;padding:2px 4px;box-shadow:0 1px 4px 0 rgba(0,0,0,.04);cursor:pointer;transition:border .15s,box-shadow .15s;display:flex;align-items:center;justify-content:center;min-width:24px;min-height:24px;width:24px;height:24px}.bubble-action-btn .icon[data-v-903c9360]{font-size:14px;width:14px;height:14px}.bubble-action-btn.header-btn[data-v-903c9360]{padding:2px;min-width:20px;min-height:20px;width:25px;height:25px}.bubble-action-btn.header-btn .icon[data-v-903c9360]{font-size:12px;width:12px;height:12px}.bubble-action-btn[data-v-903c9360]:hover{border:solid 1px var(--secondary-border,var(--primary));box-shadow:0 2px 8px 0 rgba(61,152,211,.1)}.chat-msg-text[data-v-903c9360],[data-v-903c9360]  pre{word-break:break-word;white-space:pre-line;list-style-position:inside}.chat-msg-section[data-v-903c9360],.chat-msg-section-footer[data-v-903c9360]{margin-top:8px}.chat-msg-timestamp[data-v-903c9360]{font-size:.75rem;color:#94a3b8;margin-top:8px;margin-bottom:8px;align-self:flex-end}.icon-action-source[data-v-903c9360]{width:16px;height:16px;min-width:16px;min-height:16px;display:inline-block;vertical-align:middle}.inline-button[data-v-903c9360]{margin-left:auto;height:15px;min-height:15px}.chat-msg-user-expanded[data-v-903c9360]{display:block;margin-top:16px}.chat-msg-user-expanded[data-v-903c9360]  ul{padding:0 0 0 8px;margin:0;margin-top:-10px}.chat-msg-user-context-tags[data-v-903c9360]{display:flex;flex-wrap:wrap;max-width:100%;align-items:center;justify-content:flex-end;gap:4px}.chat-msg-user-context-tag[data-v-903c9360]{background-color:transparent;color:#9fabc6;height:16px;border-radius:8px;font-size:.75rem;border:1px solid #9fabc6;border-radius:3px;margin:0;cursor:default}",""]),t["default"]=c},624:function(e,t,a){var n=a(4320);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("a18a4c12",n,!0,{sourceMap:!1,shadowMode:!1})},1097:function(e,t,a){var n=a(2521);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("9a545190",n,!0,{sourceMap:!1,shadowMode:!1})},1304:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".chat-container[data-v-3c758d33]{display:flex;flex-direction:row;height:calc(100vh - 55px);position:relative;z-index:20}.chat-panel[data-v-3c758d33]{width:100%;background:var(--box-bg);display:flex;flex-direction:column;margin:0 auto;font-family:Inter,Arial,sans-serif}.resize-bar[data-v-3c758d33]{position:absolute;top:0;left:0;width:4px;height:100%;cursor:ew-resize;background:transparent;transition:background .2s;z-index:20;opacity:0}.resize-bar[data-v-3c758d33]:hover{background:var(--primary);opacity:1}",""]),t["default"]=c},2415:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".chat-header[data-v-a5fd69bc]{background:var(--active-nav);color:var(--on-active);padding:12px 16px;display:flex;align-items:center;gap:16px}.chat-title[data-v-a5fd69bc]{display:flex;flex-direction:row;align-items:baseline;min-width:0;flex:1}.chat-title .chat-name[data-v-a5fd69bc]{display:flex;gap:12px;align-items:center;font-weight:600;font-size:1em;color:var(--on-active);margin:0;width:60px}.chat-title .chat-name .label[data-v-a5fd69bc]{font-size:1.3em}.chat-close-btn[data-v-a5fd69bc]{background:transparent;border:none;cursor:pointer;border-radius:8px;transition:background .2s}.chat-close-btn .btn-close[data-v-a5fd69bc]{margin:0 8px}.chat-close-btn[data-v-a5fd69bc]:hover{background:var(--active-hover)}.btn-close[data-v-a5fd69bc]{margin:0!important}.icon-close[data-v-a5fd69bc]{width:32px}",""]),t["default"]=c},2521:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".user-msg-avatar[data-v-3549b675]{width:32px;height:32px;border-radius:50%;background:var(--body-bg);border:1px solid var(--border);color:var(--primary);display:flex;align-items:center;justify-content:center;flex-shrink:0}.round-avatar[data-v-3549b675]{border:0;border-radius:50%}",""]),t["default"]=c},2572:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".chat-msg-action-title[data-v-7f9f3886]{display:flex;align-items:center;gap:4px;color:var(--on-secondary)}.chat-msg-action-title span[data-v-7f9f3886]{font:9px sans-serif;font-weight:500}.chat-msg-action-tags[data-v-7f9f3886]{display:flex;gap:4px;flex-wrap:wrap;margin-top:4px}.chat-msg-actions[data-v-7f9f3886]{display:flex;gap:6px;flex-wrap:wrap;margin-top:2px}",""]),t["default"]=c},3009:function(e,t,a){var n=a(4593);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("432c19a4",n,!0,{sourceMap:!1,shadowMode:!1})},3188:function(e,t,a){var n=a(4948);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("5a324ef2",n,!0,{sourceMap:!1,shadowMode:!1})},3301:function(e,t,a){var n=a(4005);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("330d2a45",n,!0,{sourceMap:!1,shadowMode:!1})},3310:function(e,t,a){var n=a(5518);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("bba9f36e",n,!0,{sourceMap:!1,shadowMode:!1})},3527:function(e,t,a){var n=a(6103);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("11a1e72a",n,!0,{sourceMap:!1,shadowMode:!1})},4005:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".chat-messages[data-v-5d7e520c]{flex:1;overflow-y:auto;padding:16px 10px 0 8px;display:flex;flex-direction:column;gap:16px}",""]),t["default"]=c},4131:function(e,t,a){var n=a(483);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("507c4ed7",n,!0,{sourceMap:!1,shadowMode:!1})},4271:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".confirmation-message[data-v-4c0960ae]{margin-bottom:12px}.confirmation-message span[data-v-4c0960ae]{word-break:break-word;white-space:pre-line;list-style-position:inside}.confirmation-buttons[data-v-4c0960ae],.delete-confirmation[data-v-4c0960ae],.standard-confirmation[data-v-4c0960ae]{display:flex;justify-content:flex-end;gap:8px}.confirmation-status .status-canceled[data-v-4c0960ae],.confirmation-status .status-confirmed[data-v-4c0960ae]{display:flex;flex-direction:row;align-items:center;gap:4px;justify-content:flex-end}.confirmation-status .status-confirmed .icon[data-v-4c0960ae]{color:var(--success)}.confirmation-status .status-canceled .icon[data-v-4c0960ae]{color:var(--error)}.rc-button-label[data-v-4c0960ae]{word-break:break-word;white-space:pre-line;list-style-position:inside}",""]),t["default"]=c},4320:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".suggestions-header[data-v-aa1b4976]{margin-bottom:8px;font-weight:600}.suggestions-list[data-v-aa1b4976]{padding:0;margin:0;padding-left:24px}.suggestion-item[data-v-aa1b4976],.suggestions-list li[data-v-aa1b4976]{padding:0;margin:0}.rc-button-label[data-v-aa1b4976]{word-break:break-word;white-space:pre-line;list-style-position:inside}",""]),t["default"]=c},4403:function(e,t,a){var n=a(5699);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("627d4128",n,!0,{sourceMap:!1,shadowMode:!1})},4593:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".chat-msg-source-label[data-v-05cb768e]{display:flex;align-items:center;gap:4px;color:#9fabc6}.chat-msg-source-label span[data-v-05cb768e]{font:9px sans-serif;font-weight:500}.chat-msg-source-tags[data-v-05cb768e]{display:flex;gap:4px;flex-wrap:wrap;margin-top:6px}.chat-msg-source-tag[data-v-05cb768e]{color:#9fabc6;border-radius:8px;padding:2px 8px;font-size:.75rem;border:1px solid #9fabc6}",""]),t["default"]=c},4948:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".system-msg-avatar[data-v-7bae8fb7]{width:32px;height:32px;border-radius:50%;background:var(--body-bg);border:1px solid var(--border);color:#22c55e;display:flex;align-items:center;justify-content:center;flex-shrink:0}",""]),t["default"]=c},5016:function(e,t,a){var n=a(1304);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("51e14435",n,!0,{sourceMap:!1,shadowMode:!1})},5518:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".disabled{opacity:.5;pointer-events:none}",""]),t["default"]=c},5690:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".rc-button-label[data-v-540f1b22]{word-break:break-word;white-space:pre-line;list-style-position:inside}.link[data-v-540f1b22]{cursor:pointer}",""]),t["default"]=c},5699:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".tags[data-v-077e02dc]{flex-wrap:wrap;max-width:100%;align-items:center;color:var(--active-nav)}.tag[data-v-077e02dc],.tags[data-v-077e02dc]{display:flex;gap:5px}.tag[data-v-077e02dc]{flex-direction:row;height:25px;line-height:1;margin-right:5px;margin-left:0;padding:0 5px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:pointer}.tag .tag-content[data-v-077e02dc]{display:flex;justify-content:center;gap:5px}.tag .vs__deselect[data-v-077e02dc]{margin:0}.vs__selected[data-v-077e02dc]{border:solid 1px var(--active-nav);color:var(--active-nav)}",""]),t["default"]=c},6103:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".chat-console[data-v-ab1486f4]{display:flex;flex-direction:column;padding:16px 16px 16px 12px;gap:.75rem;border-top:1px solid var(--border);min-height:70px}.chat-model[data-v-ab1486f4]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;min-width:0;flex:1 1 auto}.chat-console-row[data-v-ab1486f4]{display:flex;align-items:end;gap:8px;border-bottom-left-radius:8px;border-bottom-right-radius:8px}.chat-input[data-v-ab1486f4]{flex:1;border:1px solid var(--border);border-radius:8px;padding:8px 16px;font-size:1rem;outline:none;color:var(--input-text);transition:border .2s;width:auto;outline-offset:0;resize:none;overflow:auto;min-height:36px;max-height:90px}.chat-input[data-v-ab1486f4]:focus{border:solid 1.5px var(--secondary-border,var(--primary))}.chat-input-send .btn[data-v-ab1486f4]{height:36px}",""]),t["default"]=c},6134:function(e,t,a){var n=a(6550);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("6a47f8a5",n,!0,{sourceMap:!1,shadowMode:!1})},6319:function(e,t,a){var n=a(2415);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("5b9aef5e",n,!0,{sourceMap:!1,shadowMode:!1})},6457:function(e,t,a){var n=a(9897);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("5c51cf5a",n,!0,{sourceMap:!1,shadowMode:!1})},6550:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".chat-context[data-v-3b74eddd]{border-top:1px solid var(--border);padding:12px 16px;display:flex;align-items:center;gap:8px;font-size:.85rem}",""]),t["default"]=c},6735:function(e,t,a){var n=a(4271);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("2eaa5b14",n,!0,{sourceMap:!1,shadowMode:!1})},7084:function(e,t,a){var n=a(2572);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("6e2aa3ae",n,!0,{sourceMap:!1,shadowMode:!1})},7134:function(e,t,a){var n=a(94);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=a(4825).A;o("f2e1c038",n,!0,{sourceMap:!1,shadowMode:!1})},8435:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Lt}});var n=a(9274),o=a(5359),s=a(3100);function r(e){const t=(0,o.Pj)(),a=(0,n.computed)(()=>t.getters["rancher-ai-ui/connection/ws"]),s=(0,n.computed)(()=>t.getters["rancher-ai-ui/connection/error"]);async function r(a,n,o){const s=`wss://${window.location.host}/api/v1/namespaces/${a}/services/http:${n}:80/proxy/${o}`,{onopen:r,onmessage:c,onclose:i}=e;await t.dispatch("rancher-ai-ui/connection/open",{url:s,onopen:r,onmessage:c,onclose:i||(()=>{t.commit("rancher-ai-ui/connection/setError",{key:"ai.error.websocket.disconnected"})})})}function c(n={showError:!0}){!n||void 0===n.showError||e.onclose||n.showError||(a.value.onclose=null),t.commit("rancher-ai-ui/connection/close")}return{ws:a,error:s,connect:r,disconnect:c}}function c(){const e=(0,o.Pj)(),t=(0,n.computed)(()=>e.getters["rancher-ai-ui/context/all"]),a=(0,n.ref)([]);function s(e){a.value=e}return(0,n.onBeforeUnmount)(()=>{e.commit("rancher-ai-ui/context/reset")}),{context:t,selectContext:s,selectedContext:a}}var i=a(2766),l=a(9557),d=a(6198),u=a(5664),m=a(4364);const p="default",g=!1;function f(){const e=(0,o.Pj)(),t=e.getters["i18n/t"],a=(0,n.computed)(()=>Object.values(e.getters["rancher-ai-ui/chat/messages"](p))),s=(0,n.ref)({}),r=(0,n.computed)(()=>e.getters["rancher-ai-ui/chat/error"](p)),f=(0,n.computed)(()=>a.value.find(e=>e.confirmation?.status===i._r.Pending)),{selectContext:v,selectedContext:h}=c();function b(e,t){let a=i.Xh.User,n="",o=e,s=h.value;e&&"object"===typeof e&&e.messageContent&&(a=e.role,n=e.summaryContent||"",o=e.messageContent||"",s=e.contextContent||[]),t.send((0,l.mP)(o,h.value)),k({role:a,summaryContent:n,messageContent:o,contextContent:s})}async function k(t){return await e.dispatch("rancher-ai-ui/chat/addMessage",{chatId:p,message:t})}function x(t){e.commit("rancher-ai-ui/chat/updateMessage",{chatId:p,message:t})}function y(e,t){t.send((0,l.mP)(e?"yes":"no",[])),x({...s.value,confirmation:{action:s.value.confirmation?.action||null,status:e?i._r.Confirmed:i._r.Canceled}})}function w(t){return e.getters["rancher-ai-ui/chat/message"]({chatId:p,messageId:t})}function C(){a.value.length>0||k({role:i.Xh.System,messageContent:t("ai.message.system.welcome")})}async function E(a){const n=a.data;try{switch(n){case i.vw.MessageStart:const e=await k({role:i.Xh.Assistant,thinkingContent:"",messageContent:"",showThinking:g,thinking:!1,completed:!1});s.value=w(e);break;case i.vw.ThinkingStart:s.value.thinking=!0;break;case i.vw.ThinkingEnd:s.value.thinking=!1;break;case i.vw.MessageEnd:s.value.messageContent=s.value.messageContent?.replace(/[\r\n]+$/,""),s.value.thinking=!1,s.value.completed=!0;break;default:if(!1===s.value.completed&&!0===s.value.thinking){if(!s.value.thinkingContent&&""===n.trim())break;s.value.thinkingContent+=n;break}if(!1===s.value.completed&&!1===s.value.thinking){if(!s.value.messageContent&&""===n.trim())break;if(n.startsWith(i.vw.McpResultStart)&&n.endsWith(i.vw.McpResultEnd)){s.value.relatedResourcesActions=(0,l.YH)(n);break}if(n.startsWith(i.vw.ConfirmationStart)&&n.endsWith(i.vw.ConfirmationEnd)){const e=(0,l.Hx)(n);if(e){s.value.confirmation={action:e,status:i._r.Pending},s.value.thinking=!1,s.value.completed=!0;break}}if(n.startsWith(i.vw.ErrorStart)&&n.endsWith(i.vw.ErrorEnd)){const e=(0,l.NR)(n);throw e}if(s.value.messageContent+=n,s.value.messageContent?.includes(i.vw.SuggestionsStart)&&s.value.messageContent?.includes(i.vw.SuggestionsEnd)){const{suggestionActions:e,remaining:t}=(0,l.hS)(s.value.suggestionActions||[],s.value.messageContent);s.value.suggestionActions=e,s.value.messageContent=t;break}break}break}}catch(o){m.error("Error processing messages:",o),e.commit("rancher-ai-ui/chat/setError",{chatId:p,error:{message:`${t("ai.error.message.processing")} ${o.message||o||""}`}})}}function _(){e.commit("rancher-ai-ui/chat/setError",{chatId:p,error:null})}function B(){const t=e.getters["rancher/byId"](u.k$.PRINCIPAL,e.getters["auth/principalId"])||{};(0,d.PE)(`Rancher-liz-chat-${p}_${(new Date).toISOString().slice(0,10)}.txt`,(0,l.eY)(t,a.value))}function N(){e.commit("rancher-ai-ui/chat/resetMessages",p)}return(0,n.onMounted)(()=>{e.commit("rancher-ai-ui/chat/init",p)}),{onopen:C,onmessage:E,messages:a,sendMessage:b,addMessage:k,updateMessage:x,confirmMessage:y,selectContext:v,resetChatError:_,downloadMessages:B,resetMessages:N,pendingConfirmation:f,error:r}}var v=a(741),h=a(2774),b=a(1160),k=a(7157);function x(){const e=(0,o.Pj)(),{onTabClose:t}=(0,h.A)(),{setDimensions:a}=(0,b.A)({position:v.A.panelPosition}),{mouseResizeXStart:n}=(0,k.A)({position:v.A.panelPosition,setDimensions:a});function s(e){n(e)}function r(){t(v.A.panelId),v.A.close(e)}function c(){v.A.restoreDefaultPositions(e)}return{resize:s,close:r,restore:c}}var y=a(2331),w=a(5505),C=a.n(w),E=a(7319);function _(){const e=(0,o.Pj)(),t=e.getters["i18n/t"],a=(0,n.ref)(null),r=(0,n.ref)(null);function c(e){const a={},{OLLAMA_URL:n,GOOGLE_API_KEY:o,OPENAI_API_KEY:s,MODEL:r}=e;if(n?a.name=t("ai.agent.models.ollama"):o?a.name=t("ai.agent.models.gemini"):s&&(a.name=t("ai.agent.models.openai")),a.name){try{const e=C().parse((0,y.u)(r||""));a.model=e||"unknown"}catch(c){(0,E.R)("Error parsing agent model version",c)}return a}return null}async function l(){if(e.getters["management/schemaFor"](u.oU.DEPLOYMENT))try{const a=await e.dispatch("management/find",{type:u.oU.DEPLOYMENT,id:`${s.AGENT_NAMESPACE}/${s.AGENT_NAME}`});a&&"active"!==a.state&&(r.value={key:"ai.error.agent.notActive",action:{label:t("ai.agent.goToDeployment"),type:i.X2.Button,resource:{cluster:"local",type:u.oU.DEPLOYMENT,namespace:s.AGENT_NAMESPACE,name:s.AGENT_NAME}}})}catch(a){(0,E.R)("'rancher-ai-agent' deployment not found",a),r.value={key:"ai.error.agent.notFound",action:{label:t("ai.agent.goToInstall"),type:i.X2.Button,resource:{detailLocation:{name:"c-cluster-apps-charts"}}}}}else(0,E.R)("Deployment schema not found");return!r.value}async function d(){try{const t=await e.dispatch("management/find",{type:u.bB,id:`${s.AGENT_NAMESPACE}/${s.AGENT_CONFIG_SECRET_NAME}`});t?.data&&(a.value=c(t.data))}catch(n){(0,E.R)("Error fetching agent configuration secret:",n)}a.value||(r.value={key:"ai.error.agent.missingConfig",action:{label:t("ai.settings.goToSettings"),type:i.X2.Button,resource:{detailLocation:{name:`c-cluster-settings-${s.PRODUCT_NAME}`}}}})}return(0,n.onMounted)(async()=>{const e=await l();e&&d()}),{agent:a,error:r}}var B=a(5530),N=a(9694);const A={class:"chat-console-menu-container"};var M=(0,n.defineComponent)({__name:"Menu",props:{disabled:{type:Boolean,default:!1}},emits:["download:chat","reset:chat","show:help","config:chat"],setup(e,{emit:t}){const a=(0,o.Pj)(),s=a.getters["i18n/t"],r=e,c=t,i=(0,n.ref)([{label:s("ai.options.chat.download.label"),description:s("ai.options.chat.download.description"),icon:"icon-download",action:()=>{c("download:chat")}},{label:s("ai.options.chat.reset.label"),description:s("ai.options.chat.reset.description"),icon:"icon-backup",action:()=>{c("reset:chat")}},{label:s("ai.options.chat.config.label"),description:s("ai.options.chat.config.description"),icon:"icon-gear",action:()=>{c("config:chat")}}]),l=(0,n.ref)(!1);return(e,t)=>{const a=(0,n.resolveDirective)("clean-tooltip");return(0,n.openBlock)(),(0,n.createElementBlock)("div",A,[(0,n.createVNode)((0,n.unref)(N.Jj),{class:"menu-dropdown",placement:"top-end","onUpdate:open":t[0]||(t[0]=e=>l.value=e)},{dropdownCollection:(0,n.withCtx)(()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(i.value,(e,t)=>(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(N.s$),{key:t,onClick:e.action},{before:(0,n.withCtx)(()=>[e.icon?((0,n.openBlock)(),(0,n.createElementBlock)("i",{key:0,class:(0,n.normalizeClass)(["icon",e.icon])},null,2)):(0,n.createCommentVNode)("",!0)]),default:(0,n.withCtx)(()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.label)+" ",1)]),_:2},1032,["onClick"])),[[a,e.description]])),128))]),default:(0,n.withCtx)(()=>[(0,n.createVNode)((0,n.unref)(N.Nq),{ghost:"",small:"",disabled:r.disabled},{default:(0,n.withCtx)(()=>t[1]||(t[1]=[(0,n.createElementVNode)("i",{class:"icon icon-actions"},null,-1)])),_:1,__:[1]},8,["disabled"])]),_:1})])}}});const V=M;var T=V;const S={class:"chat-header"},D={class:"chat-title"},P={class:"chat-name"},I={class:"label"},z={class:"chat-menu"},j={class:"chat-close-btn"};var $=(0,n.defineComponent)({__name:"Header",emits:["close","download:chat","reset:chat","show:help","config:chat"],setup(e,{emit:t}){const a=(0,o.Pj)(),s=a.getters["i18n/t"],r=t;return(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",S,[(0,n.createElementVNode)("div",D,[(0,n.createElementVNode)("div",P,[t[7]||(t[7]=(0,n.createElementVNode)("i",{class:"icon icon-ai icon-lg"},null,-1)),(0,n.createElementVNode)("span",I,(0,n.toDisplayString)((0,n.unref)(s)("ai.header.title")),1)])]),(0,n.createElementVNode)("div",z,[(0,n.createVNode)(T,{"onDownload:chat":t[0]||(t[0]=e=>r("download:chat")),"onReset:chat":t[1]||(t[1]=e=>r("reset:chat")),"onShow:help":t[2]||(t[2]=e=>r("show:help")),"onConfig:chat":t[3]||(t[3]=e=>r("config:chat"))})]),(0,n.createElementVNode)("div",j,[(0,n.createVNode)(B.A,{small:"",ghost:"",class:"btn-close",onClick:t[4]||(t[4]=e=>r("close")),onKeydown:[t[5]||(t[5]=(0,n.withKeys)((0,n.withModifiers)(e=>r("close"),["stop"]),["enter"])),t[6]||(t[6]=(0,n.withKeys)((0,n.withModifiers)(e=>r("close"),["stop"]),["space","enter"]))]},{default:(0,n.withCtx)(()=>t[8]||(t[8]=[(0,n.createElementVNode)("i",{class:"icon icon-close"},null,-1)])),_:1,__:[8]})])]))}}),L=(a(6319),a(7433));const U=(0,L.A)($,[["__scopeId","data-v-a5fd69bc"]]);var R=U;const X={class:"thinking-message"},O={class:"dots"};var G=(0,n.defineComponent)({__name:"Thinking",props:{label:{type:String,default:""}},setup(e){const t=(0,o.Pj)(),a=t.getters["i18n/t"],s=(0,n.ref)(Date.now());let r;const c=e,i=(0,n.computed)(()=>{const e=Math.floor(s.value/500%4);return".".repeat(e)});return(0,n.onMounted)(()=>{r=setInterval(()=>{s.value=Date.now()},500)}),(0,n.onBeforeUnmount)(()=>{r&&clearInterval(r)}),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",X,[(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(c.label||(0,n.unref)(a)("ai.message.assistant.thinking.inProgress")),1),(0,n.createElementVNode)("div",O,[(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(i.value),1)])]))}});a(7134);const F=(0,L.A)(G,[["__scopeId","data-v-611b6c7d"]]);var H=F;const K={key:0},Y={class:"rc-button-label"},W={key:1},q={key:1},J={key:0,class:"text-muted"};var Q=(0,n.defineComponent)({__name:"RelatedResource",props:{value:{type:Object,default:()=>({})}},setup(e){const t=(0,o.Pj)(),a=e,s=(0,n.ref)(null),r=(0,n.ref)("");function c(){t.state.$router.push(s.value.detailLocation)}return(0,n.onMounted)(async()=>{if(a.value.resource.detailLocation)s.value=a.value.resource;else{const{cluster:e,type:n,namespace:o,name:r}=a.value.resource,c=t.getters["currentProduct"].inStore||"management";s.value=await t.dispatch(`${c}/find`,{cluster:e,type:n,id:o?`${o}/${r}`:r})}}),(e,t)=>{const o=(0,n.resolveDirective)("clean-tooltip");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[a.value.type===(0,n.unref)(i.X2).Button?((0,n.openBlock)(),(0,n.createElementBlock)("div",K,[(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(B.A,{small:"",secondary:"",disabled:!s.value,onClick:c},{default:(0,n.withCtx)(()=>[(0,n.createElementVNode)("span",Y,(0,n.toDisplayString)(a.value.label),1)]),_:1},8,["disabled"])),[[o,r.value]])])):(0,n.createCommentVNode)("",!0),a.value.type===(0,n.unref)(i.X2).Link?((0,n.openBlock)(),(0,n.createElementBlock)("span",W,[s.value?(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("a",{key:0,class:"link",onClick:c},[(0,n.createTextVNode)((0,n.toDisplayString)(a.value.label),1)])),[[o,r.value]]):((0,n.openBlock)(),(0,n.createElementBlock)("span",q,[(0,n.createTextVNode)((0,n.toDisplayString)(a.value.label)+" ",1),a.value?(0,n.createCommentVNode)("",!0):((0,n.openBlock)(),(0,n.createElementBlock)("span",J,"—"))]))])):(0,n.createCommentVNode)("",!0)],64)}}});a(26);const Z=(0,L.A)(Q,[["__scopeId","data-v-540f1b22"]]);var ee=Z;const te={class:"chat-actions-container"},ae={class:"chat-msg-action-title"},ne={class:"chat-msg-action-tags"};var oe=(0,n.defineComponent)({__name:"index",props:{actions:{type:Array,default:()=>[]}},setup(e){const t=(0,o.Pj)(),a=t.getters["i18n/t"],s=e;return(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",te,[(0,n.createElementVNode)("div",ae,[t[0]||(t[0]=(0,n.createElementVNode)("i",{class:"icon icon-quick-action"},null,-1)),(0,n.createElementVNode)("span",null,(0,n.toDisplayString)((0,n.unref)(a)("ai.message.relatedResources.label")),1)]),(0,n.createElementVNode)("div",ne,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(s.actions,(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:t,class:"mt-2 chat-msg-actions"},[(0,n.createVNode)(ee,{value:e},null,8,["value"])]))),128))])]))}});a(7084);const se=(0,L.A)(oe,[["__scopeId","data-v-7f9f3886"]]);var re=se;const ce={class:"chat-source-container"},ie={class:"chat-msg-source-label"},le={key:0,class:"chat-msg-source-tags"};var de=(0,n.defineComponent)({__name:"Source",setup(e){const t=(0,o.Pj)(),a=t.getters["i18n/t"],s=(0,n.ref)(!0);return(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",ce,[(0,n.createElementVNode)("div",ie,[t[1]||(t[1]=(0,n.createElementVNode)("i",{class:"icon icon-sources"},null,-1)),(0,n.createElementVNode)("span",null,(0,n.toDisplayString)((0,n.unref)(a)("ai.message.source.label")),1),(0,n.createElementVNode)("i",{class:(0,n.normalizeClass)(["icon icon-sm",{"icon icon-chevron-up text-label":!s.value,"icon icon-chevron-down text-label":s.value}]),onClick:t[0]||(t[0]=e=>s.value=!s.value)},null,2)]),s.value?(0,n.createCommentVNode)("",!0):((0,n.openBlock)(),(0,n.createElementBlock)("div",le,t[2]||(t[2]=[(0,n.createElementVNode)("span",{class:"chat-msg-source-tag"},"Cluster Management Guide",-1),(0,n.createElementVNode)("span",{class:"chat-msg-source-tag"},"Best Practices",-1)])))]))}});a(3009);const ue=(0,L.A)(de,[["__scopeId","data-v-05cb768e"]]);var me=ue;const pe={class:"confirmation-action"},ge={class:"confirmation-message"},fe={key:0,class:"confirmation-buttons"},ve={key:0,class:"delete-confirmation"},he={key:1,class:"standard-confirmation"},be={class:"rc-button-label"},ke={class:"rc-button-label"},xe={key:1,class:"confirmation-status"},ye={key:0,class:"status-confirmed"},we={key:1,class:"status-canceled"};var Ce=(0,n.defineComponent)({__name:"Confirmation",props:{value:{type:Object,default:()=>({})},messageContent:{type:String,default:""}},emits:["confirm"],setup(e,{emit:t}){const a=(0,o.Pj)(),s=a.getters["i18n/t"],r=e,c=t,l=(0,n.computed)(()=>{const e=s("ai.confirmation.message.question");if(!r.messageContent){const{kind:t,name:a,namespace:n,cluster:o}=r.value.action?.resource||{};if(t&&a&&n&&o){const c=r.value.action?.payload?.reduce((e,r)=>{const{op:c,value:i,path:l}=r||{};return c&&i&&l?`${e+s("ai.confirmation.message.description",{op:c,value:"string"===typeof i?i:JSON.stringify(i),path:l,name:a,kind:t,namespace:n,cluster:o},!0)}<br>`:e},"");if(c?.trim())return`${c}<br>${e}`}}return e});return(e,t)=>{const a=(0,n.resolveDirective)("clean-html");return(0,n.openBlock)(),(0,n.createElementBlock)("div",pe,[(0,n.createElementVNode)("div",ge,[(0,n.withDirectives)((0,n.createElementVNode)("span",null,null,512),[[a,l.value]])]),r.value.status===(0,n.unref)(i._r).Pending?((0,n.openBlock)(),(0,n.createElementBlock)("div",fe,[r.value.action?.type===(0,n.unref)(i.YB).Delete?((0,n.openBlock)(),(0,n.createElementBlock)("div",ve)):((0,n.openBlock)(),(0,n.createElementBlock)("div",he,[(0,n.createVNode)(B.A,{small:"",tertiary:"",onClick:t[0]||(t[0]=e=>c("confirm",!1))},{default:(0,n.withCtx)(()=>[(0,n.createElementVNode)("span",be,(0,n.toDisplayString)((0,n.unref)(s)("ai.confirmation.cancel")),1)]),_:1}),(0,n.createVNode)(B.A,{small:"",tertiary:"",onClick:t[1]||(t[1]=e=>c("confirm",!0))},{default:(0,n.withCtx)(()=>[(0,n.createElementVNode)("span",ke,(0,n.toDisplayString)((0,n.unref)(s)("ai.confirmation.confirm")),1)]),_:1})]))])):((0,n.openBlock)(),(0,n.createElementBlock)("div",xe,[r.value.status===(0,n.unref)(i._r).Confirmed?((0,n.openBlock)(),(0,n.createElementBlock)("div",ye,[t[2]||(t[2]=(0,n.createElementVNode)("i",{class:"icon icon-checkmark"},null,-1)),(0,n.createElementVNode)("p",null,(0,n.toDisplayString)((0,n.unref)(s)("ai.confirmation.confirmed")),1)])):r.value.status===(0,n.unref)(i._r).Canceled?((0,n.openBlock)(),(0,n.createElementBlock)("div",we,[t[3]||(t[3]=(0,n.createElementVNode)("i",{class:"icon icon-close canceled"},null,-1)),(0,n.createElementVNode)("p",null,(0,n.toDisplayString)((0,n.unref)(s)("ai.confirmation.canceled")),1)])):(0,n.createCommentVNode)("",!0)]))])}}});a(6735);const Ee=(0,L.A)(Ce,[["__scopeId","data-v-4c0960ae"]]);var _e=Ee;const Be={class:"suggestions-container"},Ne={class:"suggestions-header"},Ae={class:"suggestions-list"},Me={class:"rc-button-label"};var Ve=(0,n.defineComponent)({__name:"Suggestions",props:{suggestions:{type:Array,default:()=>[]}},emits:["select"],setup(e,{emit:t}){const a=(0,o.Pj)(),s=a.getters["i18n/t"],r=e,c=t;return(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",Be,[(0,n.createElementVNode)("div",Ne,(0,n.toDisplayString)((0,n.unref)(s)("ai.message.suggestions.label")),1),(0,n.createElementVNode)("ul",Ae,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(r.suggestions,(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("li",{key:t,class:"suggestion-item"},[(0,n.createVNode)(B.A,{tertiary:"",small:"",onClick:()=>c("select",e)},{default:(0,n.withCtx)(()=>[(0,n.createElementVNode)("span",Me,(0,n.toDisplayString)(e),1)]),_:2},1032,["onClick"])]))),128))])]))}});a(624);const Te=(0,L.A)(Ve,[["__scopeId","data-v-aa1b4976"]]);var Se=Te;const De={class:"vs__selected tag"},Pe={class:"tag-content"};var Ie=(0,n.defineComponent)({__name:"ContextTag",props:{item:{type:Object,default(){return{}}},removeEnabled:{type:Boolean,default:!0}},emits:["remove"],setup(e,{emit:t}){const a=e,o=t;return(e,t)=>{const s=(0,n.resolveDirective)("clean-tooltip");return(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("div",De,[(0,n.createElementVNode)("div",Pe,[(0,n.createElementVNode)("i",{class:(0,n.normalizeClass)(a.item.icon)},null,2),(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(a.item.valueLabel||a.item.value),1)]),a.removeEnabled?((0,n.openBlock)(),(0,n.createElementBlock)("button",{key:0,type:"button",class:"vs__deselect",onClick:t[0]||(t[0]=e=>o("remove",a.item))})):(0,n.createCommentVNode)("",!0)])),[[s,a.item.description]])}}});a(4403);const ze=(0,L.A)(Ie,[["__scopeId","data-v-077e02dc"]]);var je=ze;const $e={class:"user-msg-avatar"},Le=["src","alt"],Ue={key:1,class:"icon icon-user"};var Re=(0,n.defineComponent)({__name:"UserAvatar",setup(e){const t=(0,o.Pj)(),a=t.getters["i18n/t"],s=(0,n.computed)(()=>{const e=t.getters["rancher/byId"](u.k$.PRINCIPAL,t.getters["auth/principalId"])||{};return e?.avatarSrc});return(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",$e,[s.value?((0,n.openBlock)(),(0,n.createElementBlock)("img",{key:0,src:s.value,class:"round-avatar",width:"20",height:"20",alt:(0,n.unref)(a)("nav.alt.userAvatar")},null,8,Le)):((0,n.openBlock)(),(0,n.createElementBlock)("i",Ue))]))}});a(1097);const Xe=(0,L.A)(Re,[["__scopeId","data-v-3549b675"]]);var Oe=Xe,Ge=a.p+"img/liz-icon.fdbc7bd8.svg";const Fe={class:"system-msg-avatar"},He=["src"];var Ke=(0,n.defineComponent)({__name:"SystemAvatar",setup(e){return(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",Fe,[(0,n.createElementVNode)("img",{class:"img-svg",src:(0,n.unref)(Ge)},null,8,He)]))}});a(3188);const Ye=(0,L.A)(Ke,[["__scopeId","data-v-7bae8fb7"]]);var We=Ye;const qe={class:"chat-msg-content"},Je={key:0,class:"chat-msg-bubble-actions"},Qe={class:"chat-msg-text"},Ze={key:0},et={key:1},tt={key:0},at={key:1},nt={key:2},ot={key:1,class:"chat-msg-section-footer"},st={key:2,class:"chat-msg-section-footer"},rt={key:0,class:"chat-msg-section chat-msg-user-context-tags"},ct={key:1,class:"chat-msg-section"},it={key:2,class:"chat-msg-section"},lt={key:3,class:"chat-msg-timestamp"};var dt=(0,n.defineComponent)({__name:"index",props:{message:{type:Object,default:()=>({})},disabled:{type:Boolean,default:!1},pendingConfirmation:{type:Boolean,default:!1}},emits:["update:message","confirm:message","send:message","enable:autoscroll"],setup(e,{emit:t}){const a=(0,o.Pj)(),s=a.getters["i18n/t"],r=e,c=t,l=(0,n.computed)(()=>r.message.role===i.Xh.Assistant&&!r.message.completed&&(r.message.thinking||!r.message.formattedMessageContent)),d=(0,n.ref)(!1),u=(0,n.ref)(null),m=(0,n.ref)(null);function p(){if(!r.message.messageContent&&!r.message.thinkingContent)return;let e="";i.Xh.Assistant&&r.message.showThinking&&(e=r.message.thinkingContent||""),e+=r.message.messageContent||"",navigator.clipboard.writeText(e),d.value=!0,u.value&&clearTimeout(u.value),u.value=setTimeout(()=>{d.value=!1},1e3)}function g(){h(()=>c("send:message",r.message))}function f(){r.message.showCompleteMessage=!r.message.showCompleteMessage,(0,n.nextTick)(()=>{c("update:message",r.message)})}function v(){r.message.showThinking=!r.message.showThinking,h(()=>c("update:message",r.message))}function h(e){c("enable:autoscroll",!1),(0,n.nextTick)(()=>e()),m.value&&clearTimeout(m.value),m.value=setTimeout(()=>{c("enable:autoscroll",!0)},500)}return(0,n.onBeforeUnmount)(()=>{u.value&&clearTimeout(u.value),m.value&&clearTimeout(m.value)}),(t,a)=>{const o=(0,n.resolveDirective)("clean-tooltip"),u=(0,n.resolveDirective)("clean-html");return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(["chat-message",{"chat-message-user":r.message.role===(0,n.unref)(i.Xh).User,disabled:r.disabled}])},[((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)(r.message.role===(0,n.unref)(i.Xh).User?Oe:We),{class:"chat-msg-avatar"})),(0,n.createElementVNode)("div",qe,[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(["chat-msg-bubble",{"chat-msg-bubble-user":r.message.role===(0,n.unref)(i.Xh).User,"chat-msg-bubble-assistant":r.message.role!==(0,n.unref)(i.Xh).User,"chat-msg-bubble-error":r.message.isError}])},[r.disabled?(0,n.createCommentVNode)("",!0):((0,n.openBlock)(),(0,n.createElementBlock)("div",Je,[r.message.role===(0,n.unref)(i.Xh).Assistant&&r.message.thinkingContent?(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("button",{key:0,class:"bubble-action-btn btn header-btn role-tertiary",type:"button",role:"button",onClick:v},a[2]||(a[2]=[(0,n.createElementVNode)("i",{class:"icon icon-thinking-process"},null,-1)]))),[[o,r.message.showThinking?(0,n.unref)(s)("ai.message.actions.tooltip.hideThinking"):(0,n.unref)(s)("ai.message.actions.tooltip.showThinking")]]):(0,n.createCommentVNode)("",!0),(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("button",{class:"bubble-action-btn btn header-btn role-tertiary",type:"button",role:"button",onClick:p},[(0,n.createElementVNode)("i",{class:(0,n.normalizeClass)({"icon icon-checkmark":d.value,"icon icon-copy":!d.value})},null,2)])),[[o,(0,n.unref)(s)("ai.message.actions.tooltip.copy")]]),r.message.role!==(0,n.unref)(i.Xh).User||e.pendingConfirmation?(0,n.createCommentVNode)("",!0):(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("button",{key:1,class:"bubble-action-btn btn header-btn role-tertiary",type:"button",role:"button",onClick:g},a[3]||(a[3]=[(0,n.createElementVNode)("i",{class:"icon icon-backup"},null,-1)]))),[[o,(0,n.unref)(s)("ai.message.actions.tooltip.resend")]])])),(0,n.createElementVNode)("div",Qe,[l.value?((0,n.openBlock)(),(0,n.createElementBlock)("div",Ze,[(0,n.createVNode)(H)])):(0,n.createCommentVNode)("",!0),r.message.showThinking?((0,n.openBlock)(),(0,n.createElementBlock)("span",et,[l.value?((0,n.openBlock)(),(0,n.createElementBlock)("br",tt)):(0,n.createCommentVNode)("",!0),r.message.formattedThinkingContent?(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("span",at,null,512)),[[u,r.message.formattedThinkingContent]]):(0,n.createCommentVNode)("",!0),a[4]||(a[4]=(0,n.createElementVNode)("br",null,null,-1))])):(0,n.createCommentVNode)("",!0),r.message.summaryContent?(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("span",nt,null,512)),[[u,r.message.summaryContent]]):(0,n.createCommentVNode)("",!0),!r.message.formattedMessageContent||r.message.summaryContent&&!r.message.showCompleteMessage?(0,n.createCommentVNode)("",!0):(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("span",{key:3,class:(0,n.normalizeClass)({"chat-msg-user-expanded":!!r.message.summaryContent&&r.message.showCompleteMessage})},null,2)),[[u,r.message.formattedMessageContent]])]),r.message.suggestionActions?.length?((0,n.openBlock)(),(0,n.createElementBlock)("div",ot,[(0,n.createVNode)(Se,{suggestions:r.message.suggestionActions,onSelect:a[0]||(a[0]=e=>c("send:message",e))},null,8,["suggestions"])])):(0,n.createCommentVNode)("",!0),r.message.confirmation?((0,n.openBlock)(),(0,n.createElementBlock)("div",st,[(0,n.createVNode)(_e,{value:r.message.confirmation,"message-content":r.message.messageContent,onConfirm:a[1]||(a[1]=e=>c("confirm:message",e))},null,8,["value","message-content"])])):(0,n.createCommentVNode)("",!0),r.message.role===(0,n.unref)(i.Xh).Assistant&&r.message.thinkingContent&&r.message.showThinking?((0,n.openBlock)(),(0,n.createBlock)(B.A,{key:3,class:"inline-button",small:"",ghost:"",onClick:v},{default:(0,n.withCtx)(()=>[(0,n.createElementVNode)("a",null,(0,n.toDisplayString)((0,n.unref)(s)("ai.message.actions.hideThinking")),1)]),_:1})):(0,n.createCommentVNode)("",!0),r.message.summaryContent?((0,n.openBlock)(),(0,n.createBlock)(B.A,{key:4,class:"inline-button",small:"",ghost:"",onClick:f},{default:(0,n.withCtx)(()=>[(0,n.createElementVNode)("a",null,(0,n.toDisplayString)(r.message.showCompleteMessage?(0,n.unref)(s)("ai.message.actions.hideCompleteMessage"):(0,n.unref)(s)("ai.message.actions.showCompleteMessage")),1)]),_:1})):(0,n.createCommentVNode)("",!0)],2),r.message.role===(0,n.unref)(i.Xh).User&&r.message.contextContent?.length?((0,n.openBlock)(),(0,n.createElementBlock)("div",rt,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(r.message.contextContent,(e,t)=>((0,n.openBlock)(),(0,n.createBlock)(je,{key:t,item:e,"remove-enabled":!1,class:"chat-msg-user-context-tag"},null,8,["item"]))),128))])):(0,n.createCommentVNode)("",!0),r.message.source||r.message.role===(0,n.unref)(i.Xh).Assistant&&r.message.formattedMessageContent?((0,n.openBlock)(),(0,n.createElementBlock)("div",ct,[(0,n.createVNode)(me)])):(0,n.createCommentVNode)("",!0),r.message.relatedResourcesActions?.length?((0,n.openBlock)(),(0,n.createElementBlock)("div",it,[(0,n.createVNode)(re,{actions:r.message.relatedResourcesActions},null,8,["actions"])])):(0,n.createCommentVNode)("",!0),r.message.timestamp?((0,n.openBlock)(),(0,n.createElementBlock)("div",lt,(0,n.toDisplayString)(r.message.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),1)):(0,n.createCommentVNode)("",!0)])],2)}}});a(4131);const ut=(0,L.A)(dt,[["__scopeId","data-v-903c9360"]]);var mt=ut,pt=(0,n.defineComponent)({__name:"Messages",props:{messages:{type:Array,default:()=>[]},errors:{type:Array,default:()=>[]},pendingConfirmation:{type:Boolean,default:!1}},emits:["update:message","confirm:message","send:message"],setup(e,{emit:t}){const a=(0,o.Pj)(),s=a.getters["i18n/t"],r=e,c=t,d=(0,n.ref)(null),u=(0,n.ref)(!0),m=(0,n.computed)(()=>[...r.messages].filter(e=>e.messageContent||e.thinkingContent||e.confirmation||e.suggestionActions?.length).map(e=>({...e,formattedMessageContent:e.role===i.Xh.Assistant||e.summaryContent?(0,l.gg)(e.messageContent||""):e.messageContent,formattedThinkingContent:e.role===i.Xh.Assistant?(0,l.gg)(e.thinkingContent||""):""})).sort((e,t)=>(Number(e.timestamp)||0)-(Number(t.timestamp)||0)||`${e.id}`.localeCompare(`${t.id}`))),p=(0,n.computed)(()=>r.errors.map(e=>({role:i.Xh.System,formattedMessageContent:e.message||s(e.key),timestamp:new Date,completed:!0,isError:!0,actions:e.action?[e.action]:[]}))),g=(0,n.computed)(()=>r.errors.length>0);function f(){const e=d.value;e&&(u.value=e.scrollTop+e.clientHeight>=e.scrollHeight-2)}(0,n.watch)(()=>r.messages,()=>{(0,n.nextTick)(()=>{d.value&&u.value&&(d.value.scrollTop=d.value.scrollHeight)})},{immediate:!0,deep:!0});const v=(0,n.watch)(()=>r.errors,(e,t)=>{(0,n.nextTick)(()=>{d.value&&(e||[]).length>(t||[]).length&&(d.value.scrollTop=d.value.scrollHeight,v())})},{immediate:!0,deep:!0});return(0,n.onMounted)(()=>{d.value&&d.value.addEventListener("scroll",f)}),(0,n.onBeforeUnmount)(()=>{d.value&&d.value.removeEventListener("scroll",f)}),(t,a)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{ref_key:"messagesView",ref:d,class:"chat-messages"},[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(m.value,(t,o)=>((0,n.openBlock)(),(0,n.createBlock)(mt,{key:o,message:t,disabled:g.value,"pending-confirmation":e.pendingConfirmation,"onUpdate:message":e=>c("update:message",t),"onConfirm:message":a[0]||(a[0]=e=>c("confirm:message",e)),"onSend:message":a[1]||(a[1]=e=>c("send:message",e)),"onEnable:autoscroll":a[2]||(a[2]=e=>u.value=e)},null,8,["message","disabled","pending-confirmation","onUpdate:message"]))),128)),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(p.value,(e,t)=>((0,n.openBlock)(),(0,n.createBlock)(mt,{key:t,message:e},null,8,["message"]))),128))],512))}});a(3301);const gt=(0,L.A)(pt,[["__scopeId","data-v-5d7e520c"]]);var ft=gt;const vt={key:0,class:"context-select"},ht={key:0,class:"icon icon-pin-outlined"},bt={class:"tags"},kt={key:0,class:"context-reset"},xt={key:1,class:"text-muted no-context"};var yt=(0,n.defineComponent)({__name:"SelectContext",props:{options:{type:Array,default(){return[]}},autoSelect:{type:Array,default(){return[]}},disabled:{type:Boolean,default:!1}},emits:["update"],setup(e,{emit:t}){function a(e){return`${e.tag}_${e.value}`}const s=(0,o.Pj)(),r=s.getters["i18n/t"],c=e,i=(0,n.ref)([]),l=(0,n.ref)(!1),d=t;function u(e){i.value.find(t=>a(t)===a(e))?p(e):m(e)}function m(e){i.value.find(t=>a(t)===a(e))||(i.value=[...i.value,e],d("update",i.value))}function p(e){i.value=i.value.filter(t=>a(t)!==a(e)),d("update",i.value)}function g(){i.value=c.options,d("update",i.value)}return(0,n.watch)(()=>c.autoSelect,e=>{i.value=e,d("update",i.value)},{immediate:!0}),(0,n.watch)(()=>c.options,e=>{i.value=i.value.filter(t=>e.find(e=>a(e)===a(t))),d("update",i.value)}),(t,o)=>{const s=(0,n.resolveDirective)("clean-tooltip");return c.options.length>0?((0,n.openBlock)(),(0,n.createElementBlock)("div",vt,[(0,n.createVNode)((0,n.unref)(N.Jj),{class:"context-dropdown",placement:"top-end","onUpdate:open":o[0]||(o[0]=e=>l.value=e)},{dropdownCollection:(0,n.withCtx)(()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(c.options,(e,t)=>(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(N.s$),{key:t,onClick:t=>u(e)},{before:(0,n.withCtx)(()=>[e.icon?((0,n.openBlock)(),(0,n.createElementBlock)("i",{key:0,class:(0,n.normalizeClass)(["icon",e.icon])},null,2)):(0,n.createCommentVNode)("",!0)]),default:(0,n.withCtx)(()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.tag)+":"+(0,n.toDisplayString)(e.valueLabel||e.value)+" ",1),i.value.find(t=>a(t)===a(e))?((0,n.openBlock)(),(0,n.createElementBlock)("i",{key:0,class:(0,n.normalizeClass)({"icon icon-close":i.value.find(t=>a(t)===a(e))})},null,2)):(0,n.createCommentVNode)("",!0)]),_:2},1032,["onClick"])),[[s,e.description]])),128))]),default:(0,n.withCtx)(()=>[(0,n.createVNode)((0,n.unref)(N.Nq),{ghost:"",small:"",disabled:c.disabled},{after:(0,n.withCtx)(()=>[(0,n.createElementVNode)("i",{class:(0,n.normalizeClass)({"icon icon-chevron-up text-label":l.value,"icon icon-chevron-down text-label":!l.value})},null,2)]),default:(0,n.withCtx)(()=>[c.disabled?(0,n.createCommentVNode)("",!0):((0,n.openBlock)(),(0,n.createElementBlock)("i",ht)),(0,n.createElementVNode)("span",{class:(0,n.normalizeClass)(["text-label mr-5",{"ml-5":c.disabled}])},(0,n.toDisplayString)((0,n.unref)(r)("ai.context.add")),3)]),_:1},8,["disabled"])]),_:1}),(0,n.createElementVNode)("div",bt,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(i.value,(e,t)=>((0,n.openBlock)(),(0,n.createBlock)(je,{key:t,item:e,onRemove:t=>p(e)},null,8,["item","onRemove"]))),128))]),e.options.length!==i.value.length?((0,n.openBlock)(),(0,n.createElementBlock)("div",kt,[(0,n.createVNode)(B.A,{small:"",tertiary:"",onClick:g},{default:(0,n.withCtx)(()=>[o[1]||(o[1]=(0,n.createElementVNode)("i",{class:"icon icon-refresh mr-5"},null,-1)),(0,n.createTextVNode)(" "+(0,n.toDisplayString)((0,n.unref)(r)("ai.context.reset")),1)]),_:1,__:[1]})])):(0,n.createCommentVNode)("",!0)])):((0,n.openBlock)(),(0,n.createElementBlock)("span",xt,(0,n.toDisplayString)((0,n.unref)(r)("ai.context.none")),1))}}});a(6457);const wt=(0,L.A)(yt,[["__scopeId","data-v-92ba73b0"]]);var Ct=wt,Et=(0,n.defineComponent)({__name:"Context",props:{value:{type:Array,default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["select"],setup(e,{emit:t}){const a=e,o=t;return(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(["chat-context",{disabled:a.disabled}])},[(0,n.createVNode)(Ct,{options:a.value,"auto-select":a.value,disabled:a.disabled,onUpdate:t[0]||(t[0]=e=>o("select",e))},null,8,["options","auto-select","disabled"])],2))}});a(6134);const _t=(0,L.A)(Et,[["__scopeId","data-v-3b74eddd"]]);var Bt=_t;function Nt(){const e=(0,o.Pj)(),t=(0,n.computed)(()=>e.getters["rancher-ai-ui/input/text"]);function a(t){e.commit("rancher-ai-ui/input/text",t)}function s(e){return(e||"").split("\n").filter(e=>""!==e.trim()).join("\n").trim()}return{inputText:t,updateInput:a,cleanInput:s}}const At={class:"chat-console"},Mt={class:"chat-console-row"},Vt=["value","placeholder","disabled"],Tt={class:"chat-model label text-deemphasized"};var St=(0,n.defineComponent)({__name:"Console",props:{disabled:{type:Boolean,default:!1},agent:{type:Object,default:null}},emits:["input:content"],setup(e,{emit:t}){const a=(0,o.Pj)(),s=a.getters["i18n/t"],r=e,c=t,{inputText:i,updateInput:l,cleanInput:d}=Nt(),u=(0,n.ref)(null),m=(0,n.computed)(()=>r.disabled?"":i.value);function p(e){l(e?.target?.value),v()}function g(e){"Enter"!==e.key||e.shiftKey||f(e)}function f(e){e.preventDefault(),e.stopPropagation(),c("input:content",d(m.value)),l("")}function v(e){const t=u.value;t&&(t.style.overflow=parseInt(t.style.height)>90?"auto":"hidden",t.style.height="auto",t.style.height=`${e||t.scrollHeight}px`)}return(0,n.onMounted)(()=>{(0,n.nextTick)(()=>{u.value?.focus()})}),(0,n.onUpdated)(()=>{(0,n.nextTick)(()=>{u.value?.focus()})}),(0,n.watch)(u,e=>{e&&(0,n.nextTick)(()=>e.focus())},{}),(0,n.watch)(()=>m.value,()=>{(0,n.nextTick)(()=>{v()})},{}),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",At,[(0,n.createElementVNode)("div",Mt,[(0,n.createElementVNode)("textarea",{ref_key:"promptTextarea",ref:u,class:(0,n.normalizeClass)(["chat-input",{disabled:r.disabled}]),rows:"1",value:m.value,placeholder:r.disabled?"":(0,n.unref)(s)("ai.prompt.placeholder"),disabled:r.disabled,autocomplete:"off",onInput:p,onKeydown:g},null,42,Vt),(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(["chat-input-send",{disabled:r.disabled}])},[(0,n.createVNode)(B.A,{small:"",disabled:!m.value||r.disabled,onClick:f,onKeydown:(0,n.withKeys)(f,["enter"])},{default:(0,n.withCtx)(()=>t[0]||(t[0]=[(0,n.createElementVNode)("i",{class:"icon icon-lg icon-send"},null,-1)])),_:1,__:[0]},8,["disabled"])],2)]),(0,n.createElementVNode)("span",Tt,(0,n.toDisplayString)(r.agent?(0,n.unref)(s)("ai.agent.label",{name:r.agent.name,model:r.agent.model},!0):(0,n.unref)(s)("ai.agent.unknown")),1)]))}});a(3527);const Dt=(0,L.A)(St,[["__scopeId","data-v-ab1486f4"]]);var Pt=Dt;const It={class:"chat-container"},zt={class:"chat-panel"};var jt=(0,n.defineComponent)({__name:"Chat",setup(e){const t=(0,o.Pj)(),{agent:a,error:i}=_(),{messages:l,onopen:d,onmessage:u,sendMessage:m,updateMessage:p,confirmMessage:g,downloadMessages:h,resetMessages:b,selectContext:k,resetChatError:y,pendingConfirmation:w,error:C}=f(),{ws:E,connect:B,disconnect:N,error:A}=r({onopen:d,onmessage:u}),{context:M}=c(),{resize:V,close:T,restore:S}=x(),D=(0,n.computed)(()=>i.value?[i.value]:[A.value,C.value].filter(e=>e));function P(){y(),T()}function I(){b(),y(),N({showError:!1}),(0,n.nextTick)(()=>{B(s.AGENT_NAMESPACE,s.AGENT_NAME,s.AGENT_API_PATH)})}function z(){t.state.$router.push({name:`c-cluster-settings-${s.PRODUCT_NAME}`,params:{cluster:t.state.$route.params.cluster||"local"}})}function j(){v.A.isOpen(t)||E.value?.readyState===WebSocket.OPEN||N(),S()}return(0,n.onMounted)(()=>{B(s.AGENT_NAMESPACE,s.AGENT_NAME,s.AGENT_API_PATH),window.addEventListener("beforeunload",j)}),(0,n.onBeforeUnmount)(()=>{j(),window.removeEventListener("beforeunload",j)}),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",It,[(0,n.createElementVNode)("div",{class:"resize-bar",onMousedown:t[0]||(t[0]=(0,n.withModifiers)((...e)=>(0,n.unref)(V)&&(0,n.unref)(V)(...e),["prevent","stop"])),onTouchstart:t[1]||(t[1]=(0,n.withModifiers)((...e)=>(0,n.unref)(V)&&(0,n.unref)(V)(...e),["prevent","stop"]))},null,32),(0,n.createElementVNode)("div",zt,[(0,n.createVNode)(R,{onClose:P,"onConfig:chat":z,"onDownload:chat":(0,n.unref)(h),"onReset:chat":I},null,8,["onDownload:chat"]),(0,n.createVNode)(ft,{messages:(0,n.unref)(l),errors:D.value,"pending-confirmation":!!(0,n.unref)(w),"onUpdate:message":(0,n.unref)(p),"onConfirm:message":t[2]||(t[2]=e=>(0,n.unref)(g)(e,(0,n.unref)(E))),"onSend:message":t[3]||(t[3]=e=>(0,n.unref)(m)(e,(0,n.unref)(E)))},null,8,["messages","errors","pending-confirmation","onUpdate:message"]),(0,n.createVNode)(Bt,{value:(0,n.unref)(M),disabled:D.value.length>0,onSelect:(0,n.unref)(k)},null,8,["value","disabled","onSelect"]),(0,n.createVNode)(Pt,{disabled:!(0,n.unref)(E)||3===(0,n.unref)(E).readyState||D.value.length>0||!!(0,n.unref)(w),agent:(0,n.unref)(a),"onInput:content":t[4]||(t[4]=e=>(0,n.unref)(m)(e,(0,n.unref)(E)))},null,8,["disabled","agent"])])]))}});a(5016),a(3310);const $t=(0,L.A)(jt,[["__scopeId","data-v-3c758d33"]]);var Lt=$t},9897:function(e,t,a){"use strict";a.r(t);var n=a(6758),o=a.n(n),s=a(6173),r=a.n(s),c=r()(o());c.push([e.id,".context-select[data-v-92ba73b0],.tags[data-v-92ba73b0]{display:flex;flex-wrap:wrap;max-width:100%;align-items:center;gap:5px;color:var(--active-nav)}.context-select[data-v-92ba73b0]{gap:10px}.no-context[data-v-92ba73b0]{margin:7px 0 7px 0}.icon-pin-outlined[data-v-92ba73b0]{color:var(--active-nav)}",""]),t["default"]=c}}]);
//# sourceMappingURL=rancher-ai-ui-0.1.8.umd.min.194.js.map